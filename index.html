<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <meta name="description" content="Search Free Fire game items by name or description to retrieve item ID, name & details. Battle in Style and be the last survivor!" />
  <meta property="og:description" content="Search Free Fire game items by name or description to retrieve item ID, name & details." />
  <meta name="keywords" content="Free Fire items, Free Fire item ID, FF items list, Starexx FF, Garena Free Fire, battle royale, Starexx Items, Free Fire items, Free Fire item ID, Garena Free Fire, FF items database, weapon skins, character skins, emotes, bundles, parachutes, loot crates, pet skins, Free Fire cosmetics, Free Fire shop items, FF rare items, FF weapon upgrades, Free Fire gun skins, FF character costumes, Free Fire emoticons, FF vehicle skins, Free Fire gloo wall skins, FF backpacks, Free Fire melee weapons" />
  <meta property="og:title" content="FFItems" />
  <meta property="og:image" content="https://9112000.github.io/FFItems/icons/android-chrome-192x192.png" />
  <meta property="og:type" content="website" />
  <meta name="author" content="Starexx" />
  <meta property="og:url" content="https://9112000.github.io/FFItems/" />
  <meta name="twitter:card" content="summary_large_image" />
  <title>Free Fire Items</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
  <meta name="twitter:title" content="FFItems - Free Fire Items Library" />
  <meta name="twitter:description" content="Quickly find Free Fire item IDs, names & details." />
  <meta name="twitter:image" content="https://9112000.github.io/FFItems/icons/android-chrome-192x192.png" />
  <meta name="google-site-verification" content="joLKEyzfZROYT_Ck4mea3yx94rNwOqRwqalvV-xcA8U" />
  <link rel="canonical" href="https://9112000.github.io/FFItems/" />
  <meta name="robots" content="index, follow" />
</head>
<style>
  :root {
    --bg-primary: #000000;
    --bg-secondary: #111111;
    --bg-tertiary: #121212;
    --bg-card: transparent;
    --border-primary: #222222;
    --border-secondary: #333333;
    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --text-muted: #888888;
    --accent-primary: #ffffff;
    --accent-secondary: #333;
    --hover-primary: #181818;
    --modal-bg: #111111;
    --modal-border: #222222;
    --header-height: 60px;
    --pill-radius: 20px;
    --modal-radius: 20px;
    --box-radius: 20px;
    --transition-fast: 0.15s ease;
    --transition-medium: 0.2s ease;
    --transition-slow: 0.3s ease;
    --transition-modal: 0.4s cubic-bezier(.4,0,.2,1);
    --transition-flip: 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow-modal: 0 10px 30px rgba(0,0,0,0.5);
    --blur-backdrop: blur(4px);
    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    --font-mono: 'IBM Plex Mono', monospace;
    --font-size-sm: 6px;
    --font-size-md: 12px;
    --font-size-lg: 14px;
    --font-size-xl: 16px;
    --spacing-xs: 12px;
    --spacing-sm: 8px;
    --spacing-md: 8px;
    --spacing-lg: 15px;
    --spacing-xl: 20px;
    --spacing-xxl: 25px;
    --icon-size: 70%;
    --modal-icon-size: 80%;
    --grid-cols: 5;
    --items-per-page: 100;
    --max-width: 800px;
  }

  @media (min-width: 1024px) {
    :root {
      --grid-cols: 10;
      --max-width: 1200px;
      --icon-size: 80%;
    }
  }

  .ibm-plex-mono-thin {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 100;
    font-style: normal;
  }

  .ibm-plex-mono-extralight {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 200;
    font-style: normal;
  }

  .ibm-plex-mono-light {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 300;
    font-style: normal;
  }

  .ibm-plex-mono-regular {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 400;
    font-style: normal;
  }

  .ibm-plex-mono-medium {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 500;
    font-style: normal;
  }

  .ibm-plex-mono-semibold {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 600;
    font-style: normal;
  }

  .ibm-plex-mono-bold {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 700;
    font-style: normal;
  }

  .ibm-plex-mono-thin-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 100;
    font-style: italic;
  }

  .ibm-plex-mono-extralight-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 200;
    font-style: italic;
  }

  .ibm-plex-mono-light-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 300;
    font-style: italic;
  }

  .ibm-plex-mono-regular-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 400;
    font-style: italic;
  }

  .ibm-plex-mono-medium-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 500;
    font-style: italic;
  }

  .ibm-plex-mono-semibold-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 600;
    font-style: italic;
  }

  .ibm-plex-mono-bold-italic {
    font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
    font-weight: 700;
    font-style: italic;
  }

  * {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }
  ::selection {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }
  body {
    margin: 0;
    font-family: var(--font-main);
    background: var(--bg-primary);
    color: var(--text-primary);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
    user-select: none;
  }

  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: left;
    align-items: center;
    background: var(--bg-primary);
    padding: var(--spacing-md) var(--spacing-xl);
    z-index: 51;
    height: var(--header-height);
    gap: var(--spacing-md);
    flex-wrap: nowrap;
    overflow-x: auto;
    white-space: nowrap;
    max-width: 100%;
  }
  ::-webkit-scrollbar {
    display: none;
  }
  .header::-webkit-scrollbar {
    display: none;
  }

  .header {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .header-pill {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border: none;
    border-radius: var(--pill-radius);
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    transition: background var(--transition-medium), transform var(--transition-fast);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
    white-space: nowrap;
  }

  .header-pill:hover {
    background: var(--hover-primary);
  }

  .header-pill:active {
    transform: scale(0.9);
  }

  .mode-tabs {
    display: flex;
    background: transparent;
    border: none;
    border-right: 1px solid #222;
    border-radius: 0;
    padding: 0.5px 7px;
    gap: var(--spacing-xs);
  }

  .mode-tab {
    padding: 6px var(--spacing-lg);
    border: none;
    border-radius: 16px;
    background: #121212;
    color: var(--text-primary);
    cursor: pointer;
    transition: background var(--transition-medium), transform var(--transition-fast);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
  }

  .mode-tab.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
  }
  .mode-tab:active {
    transform: scale(0.9);
  }
  .main-content {
    margin-top: 50px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-cols), 1fr);
    gap: var(--spacing-md);
    width: 90%;
    max-width: var(--max-width);
    margin-bottom: var(--spacing-xl);
  }

  .box {
    background: var(--bg-tertiary);
    border-radius: var(--box-radius);
    aspect-ratio: 1 / 1;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: transform var(--transition-fast), background var(--transition-medium);
    user-select: none;
    border: 1px solid var(--border-primary);
    overflow: hidden;
  }

  .box:active {
    transform: scale(0.9);
    background: var(--hover-primary);
  }

  .icon {
    width: var(--icon-size);
    height: var(--icon-size);
    object-fit: contain;
    opacity: 0;
    transition: opacity 0.3s ease;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }

  .icon.loaded {
    opacity: 1;
  }

  .modal {
    position: fixed;
    border-radius: var(--modal-radius);
    background: var(--modal-bg);
    color: var(--text-primary);
    z-index: 100;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all var(--transition-modal);
    overflow: hidden;
    box-shadow: var(--shadow-modal);
    border: 1px solid var(--modal-border);
  }

  .modal-icon {
    width: var(--modal-icon-size);
    height: var(--modal-icon-size);
    object-fit: contain;
    cursor: pointer;
    transition: background var(--transition-medium), transform var(--transition-fast);
    opacity: 0;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
  .modal-icon.loaded {
    opacity: 1;
  }
  .modal-icon:active {
    transform: scale(0.9);
  }

  .fade-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    backdrop-filter: var(--blur-backdrop);
    opacity: 0;
    transition: opacity var(--transition-slow);
    z-index: 52;
    pointer-events: none;
  }

  .fade-bg.active {
    opacity: 1;
    pointer-events: all;
  }

  .bottom-sheet {
    position: fixed;
    bottom: 20px;
    left: 20px;
    right: 20px;
    background: var(--modal-bg);
    border-radius: 30px;
    padding: var(--spacing-lg) var(--spacing-xl) var(--spacing-xxl) var(--spacing-xl);
    z-index: 150;
    transform: translateY(150%);
    transition: transform var(--transition-slow);
    max-height: 70vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  }

  .bottom-sheet.active {
    transform: translateY(0);
  }

  .pages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: var(--spacing-md);
  }

  .sheet-page-btn {
    background: transparent;
    color: var(--text-primary);
    border: none;
    border-radius: 30px;
    padding: var(--spacing-md);
    cursor: pointer;
    transition: background var(--transition-medium);
    text-align: center;
    font-size: var(--font-size-lg);
    font-family: var(--font-main);
  }

  .sheet-page-btn.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
  }

  .sheet-page-btn:hover {
    background: var(--hover-primary);
  }

  .search-sheet {
    padding: var(--spacing-xl);
  }

  .search-input {
    width: 100%;
    padding: var(--spacing-lg) 18px;
    border-radius: 20px;
    border: 1px solid var(--border-primary);
    background: transparent;
    color: var(--text-primary);
    font-family: inherit;
    outline: none;
    font-size: var(--font-size-xl);
    margin-bottom: var(--spacing-lg);
    font-family: var(--font-main);
  }

  .search-hint {
    font-size: var(--font-size-md);
    color: var(--text-muted);
    text-align: center;
    margin-top: var(--spacing-md);
    font-family: var(--font-main);
  }

  .no-results {
    grid-column: 1 / -1;
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-muted);
    font-family: var(--font-main);
  }

  .loading {
    grid-column: 1 / -1;
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-muted);
    font-family: var(--font-main);
  }

  .search-results-text {
    font-size: var(--font-size-md);
    color: #666;
    text-align: center;
    margin: var(--spacing-md) 0;
    font-family: var(--font-main);
  }

.filter-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--spacing-md);
    margin-top: var(--spacing-lg);
}

.filter-btn {
    background: transparent;
    color: var(--text-primary);
    border: none;
    border-radius: 20px;
    padding: var(--spacing-md);
    cursor: pointer;
    transition: transform var(--transition-medium), background var(--transition-medium);
    text-align: center;
    font-size: var(--font-size-md);
    font-family: var(--font-main);
    min-height: 45px;
    width: 100%;
}

  .filter-btn.active {
    background: white;
    color: black;
  }

  .filter-btn:active {
    transform: scale(0.9);
  }

  .footer {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: var(--bg-primary);
    padding: var(--spacing-md) var(--spacing-xl);
    border: none;
    margin-top: auto;
    margin-bottom: 20px;
  }

  .footer-pill {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border: none;
    border-radius: var(--pill-radius);
    padding: var(--spacing-sm) var(--spacing-lg);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
    cursor: pointer;
    transition: transform var(--transition-fast)
  }
  .footer-pill:active {
    transform: scale(0.9);
  }
  
.details-card {
  position: fixed;
  background: var(--modal-bg);
  border-radius: var(--modal-radius);
  box-shadow: var(--shadow-modal);
  border: 1px solid var(--modal-border);
  padding: 15px;
  z-index: 101;
  display: flex;
  flex-direction: column;
  height: auto;
  overflow-y: auto;
  transform: translateY(30px);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  max-width: 90vw;
  box-sizing: border-box;
  left: 50%;
  transform: translateX(-50%) translateY(30px);
  user-select: text !important;
  pointer-events: auto !important;
}

.details-card.active {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

.details-title {
    font-size: 15px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-primary);
    font-family: "IBM Plex Mono", monospace;
    line-height: 1.3;
    word-wrap: break-word;
}

.details-properties {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.details-property {
    display: block;
    line-height: 1.4;
    font-size: 12px;
}

.details-property-label {
    font-weight: 700;
    color: var(--text-primary);
}

.details-property-value {
    font-weight: 400;
    color: var(--text-secondary);
}

.modal-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 100;
    pointer-events: none;
}

.modal-container.active {
    pointer-events: all;
}
</style>
<body>
<div class="header">
  <div class="mode-tabs">
    <button class="mode-tab active" id="itemsTab">Items</button>
    <button class="mode-tab" id="iconsTab">Icons</button>
  </div>
  <div class="header-pill type-filter" id="typePill">Type</div>
  <div class="header-pill rarity-filter" id="rarityPill">Rarity</div>
  <div class="header-pill" id="searchPill">Search</div>
</div>

<div class="main-content">
  <div id="searchResults" class="search-results-text"></div>
  <div class="grid" id="grid">
    <div class="loading"></div>
  </div>

  <div class="footer">
    <div class="footer-pill" id="pagePill">Created by Starexx</div>
  </div>
</div>

<div class="fade-bg" id="fadeBg"></div>

<div class="bottom-sheet" id="pageSheet">
  <div class="pages-grid" id="pagesGrid"></div>
</div>

<div class="bottom-sheet search-sheet" id="searchSheet">
  <input type="text" class="search-input" id="searchInput" placeholder="Search by name, item ID or icon...">
  <div class="search-hint">Type to search through all items</div>
</div>

<div class="bottom-sheet" id="typeSheet">
  <div class="filter-grid" id="typeGrid"></div>
</div>

<div class="bottom-sheet" id="raritySheet">
  <div class="filter-grid" id="rarityGrid"></div>
</div>
<script>
const FFItemsApp = (function() {
    let state = {
        grid: null,
        fadeBg: null,
        pagePill: null,
        footerPill: null,
        searchPill: null,
        typePill: null,
        rarityPill: null,
        pageSheet: null,
        searchSheet: null,
        typeSheet: null,
        raritySheet: null,
        searchInput: null,
        pagesGrid: null,
        typeGrid: null,
        rarityGrid: null,
        searchResults: null,
        itemsTab: null,
        iconsTab: null,
        
        activeClone: null,
        originalBox: null,
        detailsCard: null,
        modalContainer: null,
        currentPage: 1,
        itemsPerPage: 100,
        allItems: [],
        allIcons: [],
        filteredItems: [],
        filteredIcons: [],
        totalPages: 1,
        currentSearchQuery: "",
        currentMode: "items",
        currentType: "",
        currentRarity: "",
        allTypes: [],
        allRarities: [],
        imageCache: new Map(),
        failedImages: new Set(),
        isModalAnimating: false,
        
        rarityMap: {
            "WHITE": "COMMON",
            "BLUE": "RARE",
            "GREEN": "UNCOMMON",
            "ORANGE": "MYTHIC",
            "ORANGE_PLUS": "MYTHIC PLUS",
            "PURPLE": "EPIC",
            "PURPLE_PLUS": "EPIC PLUS",
            "RED": "ARTIFACT"
        }
    };

    function init() {
        setupElements();
        setupEventDelegation();
        // Parse URL parameters before fetching data
        parseURLParameters();
        fetchData();
    }

    function setupElements() {
        state.grid = document.getElementById('grid');
        state.fadeBg = document.getElementById('fadeBg');
        state.pagePill = document.getElementById('pagePill');
        state.footerPill = document.getElementById('footerPill');
        state.searchPill = document.getElementById('searchPill');
        state.typePill = document.getElementById('typePill');
        state.rarityPill = document.getElementById('rarityPill');
        state.pageSheet = document.getElementById('pageSheet');
        state.searchSheet = document.getElementById('searchSheet');
        state.typeSheet = document.getElementById('typeSheet');
        state.raritySheet = document.getElementById('raritySheet');
        state.searchInput = document.getElementById('searchInput');
        state.pagesGrid = document.getElementById('pagesGrid');
        state.typeGrid = document.getElementById('typeGrid');
        state.rarityGrid = document.getElementById('rarityGrid');
        state.searchResults = document.getElementById('searchResults');
        state.itemsTab = document.getElementById('itemsTab');
        state.iconsTab = document.getElementById('iconsTab');
    }

    function setupEventDelegation() {
        document.addEventListener('click', handleDocumentClick);
        document.addEventListener('touchmove', handleTouchMove, { passive: false });
        
        state.searchInput.addEventListener('input', handleSearchInput);
        state.searchInput.addEventListener('keydown', handleSearchKeydown);
        
        state.fadeBg.addEventListener('click', handleFadeBgClick);
    }

    function parseURLParameters() {
        const urlParams = new URLSearchParams(window.location.search);
        
        // Get type parameter
        const typeParam = urlParams.get('type');
        if (typeParam) {
            state.currentType = typeParam;
        }
        
        // Get rarity parameter
        const rarityParam = urlParams.get('rare');
        if (rarityParam) {
            state.currentRarity = rarityParam;
        }
        
        // Get search query parameter
        const searchParam = urlParams.get('q');
        if (searchParam) {
            state.currentSearchQuery = searchParam;
        }
    }

    function updateURLParameters() {
        const urlParams = new URLSearchParams();
        
        if (state.currentType) {
            urlParams.set('type', state.currentType);
        }
        
        if (state.currentRarity) {
            urlParams.set('rare', state.currentRarity);
        }
        
        if (state.currentSearchQuery) {
            urlParams.set('q', state.currentSearchQuery);
        }
        
        const newUrl = urlParams.toString() ? `${window.location.pathname}?${urlParams.toString()}` : window.location.pathname;
        
        // Update URL without reloading the page
        window.history.replaceState({}, '', newUrl);
    }

    function handleDocumentClick(e) {
        const target = e.target;
        
        if (target.classList.contains('mode-tab')) {
            handleModeTabClick(target);
        } else if (target.classList.contains('header-pill')) {
            handleHeaderPillClick(target);
        } else if (target.classList.contains('footer-pill')) {
            handleFooterPillClick(target);
        } else if (target.classList.contains('sheet-page-btn')) {
            handlePageButtonClick(target);
        } else if (target.classList.contains('filter-btn')) {
            handleFilterButtonClick(target);
        } else if (target.classList.contains('box') || target.closest('.box')) {
            const box = target.classList.contains('box') ? target : target.closest('.box');
            handleBoxClick(box);
        }
    }

    function handleTouchMove(e) {
        if (state.activeClone) {
            e.preventDefault();
        }
    }

    function handleSearchInput(e) {
        state.currentPage = 1;
        state.currentSearchQuery = e.target.value.trim();
        renderGrid();
        updateHeaderPills();
        updateURLParameters(); // Update URL when search changes
    }

    function handleSearchKeydown(e) {
        if (e.key === 'Enter') {
            closeAllSheets();
        }
    }

    function handleFadeBgClick(e) {
        if (e.target === state.fadeBg && !state.isModalAnimating) {
            closeModal();
            closeAllSheets();
        }
    }

    function handleModeTabClick(target) {
        const mode = target.id === 'itemsTab' ? 'items' : 'icons';
        if (state.currentMode === mode) return;
        
        state.currentMode = mode;
        state.currentPage = 1;
        state.currentSearchQuery = "";
        state.currentType = "";
        state.currentRarity = "";
        
        state.itemsTab.classList.toggle('active', mode === 'items');
        state.iconsTab.classList.toggle('active', mode === 'icons');
        
        state.searchInput.placeholder = mode === 'items' 
            ? 'Search by name, item ID or icon...' 
            : 'Search icons...';
        
        state.searchInput.value = "";
        renderGrid();
        updateURLParameters(); // Update URL when mode changes
    }

    function handleHeaderPillClick(target) {
        if (target === state.searchPill) {
            openSearchSheet();
        } else if (target === state.typePill) {
            openTypeSheet();
        } else if (target === state.rarityPill) {
            openRaritySheet();
        }
    }

    function handleFooterPillClick(target) {
        if (target === state.pagePill) {
            openPageSheet();
        }
    }

    function handlePageButtonClick(target) {
        const page = parseInt(target.textContent);
        state.currentPage = page;
        renderGrid();
        closeAllSheets();
    }

    function handleFilterButtonClick(target) {
        const parent = target.parentElement;
        
        if (parent.id === 'typeGrid') {
            if (target.textContent === 'All Types') {
                state.currentType = "";
            } else {
                state.currentType = target.textContent;
            }
        } else if (parent.id === 'rarityGrid') {
            if (target.textContent === 'All Rarities') {
                state.currentRarity = "";
            } else {
                const rarityKey = Object.keys(state.rarityMap).find(key => 
                    state.rarityMap[key] === target.textContent
                ) || target.textContent;
                state.currentRarity = rarityKey;
            }
        }
        
        state.currentPage = 1;
        renderGrid();
        closeAllSheets();
        updateURLParameters(); // Update URL when filters change
    }

    function handleBoxClick(box) {
        if (state.currentMode === 'items') {
            const index = Array.from(state.grid.children).indexOf(box);
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const actualIndex = startIndex + index;
            
            if (actualIndex >= 0 && actualIndex < state.filteredItems.length) {
                const item = state.filteredItems[actualIndex];
                openModal(box, item);
            }
        } else {
            const index = Array.from(state.grid.children).indexOf(box);
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const actualIndex = startIndex + index;
            
            if (actualIndex >= 0 && actualIndex < state.filteredIcons.length) {
                const iconName = state.filteredIcons[actualIndex];
                const item = {
                    icon: iconName,
                    name: extractIconName(iconName)
                };
                openModal(box, item);
            }
        }
    }

    function fetchData() {
        Promise.all([
            fetch('assets/itemData.json').then(r => r.ok ? r.json() : Promise.reject()),
            fetch('assets/assets.json').then(r => r.ok ? r.json() : Promise.reject())
        ])
        .then(([itemsData, iconsData]) => {
            state.allItems = itemsData;
            state.allIcons = Array.isArray(iconsData) ? iconsData : Object.values(iconsData).filter(item => typeof item === 'string');
            
            processData();
            renderGrid();
        })
        .catch(error => {
            console.error('Failed to load data:', error);
            state.grid.innerHTML = '<div class="no-results">Failed to load data. Please check if JSON files exist.</div>';
        });
    }

    function processData() {
        state.allTypes = [...new Set(state.allItems.map(item => item.type).filter(Boolean))].sort();
        state.allRarities = [...new Set(state.allItems.map(item => item.Rare).filter(Boolean))]
            .filter(rarity => rarity !== "255" && rarity !== "NONE")
            .sort();
        
        state.filteredItems = [...state.allItems];
        state.filteredIcons = [...state.allIcons];
        state.totalPages = Math.ceil(state.filteredItems.length / state.itemsPerPage);
    }

    function getImageUrl(iconName) {
        if (!iconName) return 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
        if (iconName.includes('https://')) return iconName;
        return `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${iconName}.png`;
    }

    function createImageElement(iconName, className, altText) {
        const icon = document.createElement('img');
        icon.className = className;
        icon.alt = altText || 'Free Fire Item';
        
        const imageUrl = getImageUrl(iconName);
        
        if (state.failedImages.has(imageUrl)) {
            icon.src = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
            icon.classList.add('loaded');
            return icon;
        }
        
        if (state.imageCache.has(imageUrl)) {
            icon.src = state.imageCache.get(imageUrl);
            icon.classList.add('loaded');
        } else {
            icon.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMjIyIi8+PC9zdmc+';
            
            const imgLoader = new Image();
            imgLoader.onload = () => {
                icon.src = imageUrl;
                icon.classList.add('loaded');
                state.imageCache.set(imageUrl, imageUrl);
            };
            
            imgLoader.onerror = () => {
                state.failedImages.add(imageUrl);
                icon.src = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
                icon.classList.add('loaded');
            };
            
            imgLoader.src = imageUrl;
        }
        
        return icon;
    }

    function renderGrid() {
        state.grid.innerHTML = "";
        
        if (state.currentMode === "items") {
            state.filteredItems = state.allItems.filter(item => {
                const matchesSearch = !state.currentSearchQuery || 
                    (item.name && item.name.toLowerCase().includes(state.currentSearchQuery.toLowerCase())) ||
                    (item.itemID && item.itemID.toString().includes(state.currentSearchQuery)) ||
                    (item.icon && item.icon.toLowerCase().includes(state.currentSearchQuery.toLowerCase())) ||
                    (item.description && item.description.toLowerCase().includes(state.currentSearchQuery.toLowerCase()));
                
                const matchesType = !state.currentType || item.type === state.currentType;
                const matchesRarity = !state.currentRarity || item.Rare === state.currentRarity;
                
                return matchesSearch && matchesType && matchesRarity;
            });
            
            state.totalPages = Math.ceil(state.filteredItems.length / state.itemsPerPage);
            
            if (state.filteredItems.length === 0) {
                state.grid.innerHTML = '<div class="no-results">No items found matching your filters</div>';
                updateHeaderPills();
                updateSearchResultsText();
                return;
            }
            
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const endIndex = Math.min(startIndex + state.itemsPerPage, state.filteredItems.length);
            const itemsToShow = state.filteredItems.slice(startIndex, endIndex);
            
            itemsToShow.forEach(item => {
                const box = document.createElement('div');
                box.className = 'box';
                
                const icon = createImageElement(item.icon, 'icon', item.name || 'Item Icon');
                box.appendChild(icon);
                state.grid.appendChild(box);
            });
        } else {
            if (state.currentSearchQuery) {
                state.filteredIcons = state.allIcons.filter(iconName => 
                    iconName && iconName.toLowerCase().includes(state.currentSearchQuery.toLowerCase())
                );
            } else {
                state.filteredIcons = [...state.allIcons];
            }
            
            state.totalPages = Math.ceil(state.filteredIcons.length / state.itemsPerPage);
            
            if (state.filteredIcons.length === 0) {
                state.grid.innerHTML = '<div class="no-results">No icons found matching your search</div>';
                updateHeaderPills();
                updateSearchResultsText();
                return;
            }
            
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const endIndex = Math.min(startIndex + state.itemsPerPage, state.filteredIcons.length);
            const iconsToShow = state.filteredIcons.slice(startIndex, endIndex);
            
            iconsToShow.forEach(iconName => {
                const box = document.createElement('div');
                box.className = 'box';
                
                const icon = createImageElement(iconName, 'icon', iconName);
                box.appendChild(icon);
                state.grid.appendChild(box);
            });
        }
        
        updateHeaderPills();
        updateSearchResultsText();
    }

    function extractIconName(iconString) {
        if (!iconString) return "Unknown Icon";
        if (iconString.includes('https://')) {
            const url = new URL(iconString);
            const pathSegments = url.pathname.split('/');
            const fileName = pathSegments[pathSegments.length - 1];
            return fileName.replace('.png', '');
        }
        return iconString;
    }

    function updateHeaderPills() {
        state.pagePill.textContent = `Page ${state.currentPage}/${state.totalPages}`;
        
        if (state.currentSearchQuery) {
            state.searchPill.textContent = state.currentSearchQuery.length > 10 
                ? state.currentSearchQuery.substring(0, 10) + "..." 
                : state.currentSearchQuery;
        } else {
            state.searchPill.textContent = "Search";
        }
        
        if (state.currentMode === "items") {
            document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
                el.style.display = 'block';
            });
            
            if (state.currentType) {
                state.typePill.textContent = state.currentType;
                state.typePill.classList.add('active');
            } else {
                state.typePill.textContent = "Type";
                state.typePill.classList.remove('active');
            }
            
            if (state.currentRarity) {
                let displayRarity = state.currentRarity;
                if (state.rarityMap[state.currentRarity]) {
                    displayRarity = state.rarityMap[state.currentRarity];
                }
                state.rarityPill.textContent = displayRarity;
                state.rarityPill.classList.add('active');
            } else {
                state.rarityPill.textContent = "Rarity";
                state.rarityPill.classList.remove('active');
            }
        } else {
            document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
                el.style.display = 'none';
            });
        }
    }

    function updateSearchResultsText() {
        if (state.currentSearchQuery || state.currentType || state.currentRarity) {
            const itemCount = state.currentMode === "items" ? state.filteredItems.length : state.filteredIcons.length;
            let filterText = [];
            
            if (state.currentSearchQuery) filterText.push(`"${state.currentSearchQuery}"`);
            if (state.currentType) filterText.push(`Type: ${state.currentType}`);
            if (state.currentRarity) {
                let displayRarity = state.currentRarity;
                if (state.rarityMap[state.currentRarity]) {
                    displayRarity = state.rarityMap[state.currentRarity];
                }
                filterText.push(`Rarity: ${displayRarity}`);
            }
            
            state.searchResults.textContent = `Showing results for ${filterText.join(', ')} - ${itemCount} ${state.currentMode} found`;
        } else {
            state.searchResults.textContent = "";
        }
    }

    function openTypeSheet() {
        state.typeGrid.innerHTML = "";
        
        const allBtn = document.createElement('button');
        allBtn.className = `filter-btn ${!state.currentType ? 'active' : ''}`;
        allBtn.textContent = 'All Types';
        state.typeGrid.appendChild(allBtn);
        
        state.allTypes.forEach(type => {
            const btn = document.createElement('button');
            btn.className = `filter-btn ${state.currentType === type ? 'active' : ''}`;
            btn.textContent = type;
            state.typeGrid.appendChild(btn);
        });
        
        openSheet(state.typeSheet);
    }

    function openRaritySheet() {
        state.rarityGrid.innerHTML = "";
        
        const allBtn = document.createElement('button');
        allBtn.className = `filter-btn ${!state.currentRarity ? 'active' : ''}`;
        allBtn.textContent = 'All Rarities';
        state.rarityGrid.appendChild(allBtn);
        
        state.allRarities.forEach(rarity => {
            const btn = document.createElement('button');
            btn.className = `filter-btn ${state.currentRarity === rarity ? 'active' : ''}`;
            
            let displayName = rarity;
            if (state.rarityMap[rarity]) {
                displayName = state.rarityMap[rarity];
            }
            
            btn.textContent = displayName;
            state.rarityGrid.appendChild(btn);
        });
        
        openSheet(state.raritySheet);
    }

    function openPageSheet() {
        state.pagesGrid.innerHTML = "";
        
        for (let i = 1; i <= state.totalPages; i++) {
            const btn = document.createElement('button');
            btn.className = `sheet-page-btn ${i === state.currentPage ? 'active' : ''}`;
            btn.textContent = i;
            state.pagesGrid.appendChild(btn);
        }
        
        openSheet(state.pageSheet);
    }

    function openSearchSheet() {
        state.searchInput.value = state.currentSearchQuery;
        openSheet(state.searchSheet);
        
        setTimeout(() => {
            state.searchInput.focus();
        }, 300);
    }

    function openSheet(sheet) {
        closeAllSheets();
        sheet.classList.add('active');
        state.fadeBg.classList.add('active');
        document.body.style.touchAction = 'none';
    }

    function closeAllSheets() {
        document.body.style.touchAction = '';
        state.pageSheet.classList.remove('active');
        state.searchSheet.classList.remove('active');
        state.typeSheet.classList.remove('active');
        state.raritySheet.classList.remove('active');
        state.fadeBg.classList.remove('active');
    }

    function openModal(box, item) {
        if (state.activeClone || state.isModalAnimating) return;
        
        state.isModalAnimating = true;
        document.body.style.overflow = 'hidden';
        
        const rect = box.getBoundingClientRect();
        
        state.modalContainer = document.createElement('div');
        state.modalContainer.className = 'modal-container';
        state.modalContainer.style.pointerEvents = 'none';
        document.body.appendChild(state.modalContainer);
        
        const modal = document.createElement('div');
        modal.classList.add('modal');
        modal.style.left = rect.left + 'px';
        modal.style.top = rect.top + 'px';
        modal.style.width = rect.width + 'px';
        modal.style.height = rect.height + 'px';
        modal.style.pointerEvents = 'none';
        
        const modalIcon = createImageElement(item.icon, 'modal-icon', item.name || item.icon);
        modalIcon.style.pointerEvents = 'none';
        modal.appendChild(modalIcon);
        
        state.modalContainer.appendChild(modal);
        
        state.activeClone = modal;
        state.originalBox = box;
        
        setTimeout(() => {
            state.fadeBg.classList.add('active');
            state.modalContainer.classList.add('active');
            
            modal.style.left = '50%';
            modal.style.top = 'calc(50% - 100px)';
            modal.style.transform = 'translate(-50%, -50%) scale(1.8)';
            modal.style.width = '200px';
            modal.style.height = '200px';
            
            setTimeout(() => {
                state.detailsCard = createDetailsCard(item);
                state.modalContainer.appendChild(state.detailsCard);
                
                const modalRect = modal.getBoundingClientRect();
                
                state.detailsCard.style.left = '50%';
                state.detailsCard.style.top = (modalRect.bottom + 20) + 'px';
                state.detailsCard.style.width = modalRect.width + 'px';
                state.detailsCard.style.transform = 'translateX(-50%)';
                
                setTimeout(() => {
                    state.detailsCard.classList.add('active');
                    state.isModalAnimating = false;
                }, 50);
            }, 400);
        }, 50);
    }

    function createDetailsCard(item) {
        const detailsCard = document.createElement('div');
        detailsCard.className = 'details-card';
        
        if (state.currentMode === 'icons') {
            const iconNameTitle = document.createElement('div');
            iconNameTitle.className = 'details-title ibm-plex-mono-bold';
            iconNameTitle.textContent = extractIconName(item.icon);
            detailsCard.appendChild(iconNameTitle);
        } else {
            if (item.name) {
                const title = document.createElement('div');
                title.className = 'details-title ibm-plex-mono-bold';
                let titleText = item.name;
                if (item.description) {
                    titleText += ` - ${item.description}`;
                }
                title.textContent = titleText;
                detailsCard.appendChild(title);
            }
            
            const propertiesContainer = document.createElement('div');
            propertiesContainer.className = 'details-properties';
            
            if (item.itemID) {
                const idProperty = document.createElement('div');
                idProperty.className = 'details-property';
                
                const idLabel = document.createElement('span');
                idLabel.className = 'details-property-label ibm-plex-mono-bold';
                idLabel.textContent = 'Item ID: ';
                
                const idValue = document.createElement('span');
                idValue.className = 'details-property-value ibm-plex-mono-regular';
                idValue.textContent = item.itemID;
                
                idProperty.appendChild(idLabel);
                idProperty.appendChild(idValue);
                propertiesContainer.appendChild(idProperty);
            }
            
            if (item.icon) {
                const iconProperty = document.createElement('div');
                iconProperty.className = 'details-property';
                
                const iconLabel = document.createElement('span');
                iconLabel.className = 'details-property-label ibm-plex-mono-bold';
                iconLabel.textContent = 'Icon: ';
                
                const iconValue = document.createElement('span');
                iconValue.className = 'details-property-value ibm-plex-mono-regular';
                iconValue.textContent = item.icon;
                
                iconProperty.appendChild(iconLabel);
                iconProperty.appendChild(iconValue);
                propertiesContainer.appendChild(iconProperty);
            }
            
            detailsCard.appendChild(propertiesContainer);
        }
        
        return detailsCard;
    }

    function closeModal() {
        if (!state.activeClone || !state.originalBox || state.isModalAnimating) return;
        
        state.isModalAnimating = true;
        document.body.style.overflow = '';
        
        if (state.detailsCard) {
            state.detailsCard.style.transform = 'translateX(-50%) translateY(20px)';
            state.detailsCard.style.opacity = '0';
        }
        
        state.fadeBg.classList.remove('active');
        state.modalContainer.classList.remove('active');
        
        const rect = state.originalBox.getBoundingClientRect();
        
        state.activeClone.style.left = rect.left + 'px';
        state.activeClone.style.top = rect.top + 'px';
        state.activeClone.style.width = rect.width + 'px';
        state.activeClone.style.height = rect.height + 'px';
        state.activeClone.style.transform = 'translate(0,0) scale(1)';
        
        setTimeout(() => {
            if (state.modalContainer && state.modalContainer.parentNode) {
                state.modalContainer.remove();
            }
            state.activeClone = null;
            state.modalContainer = null;
            state.detailsCard = null;
            state.isModalAnimating = false;
        }, 400);
    }

    return {
        init: init
    };
})();

document.addEventListener('DOMContentLoaded', function() {
    FFItemsApp.init();
});
</script>
</body>
</html>
