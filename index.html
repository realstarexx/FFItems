<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <meta name="description" content="Search Free Fire game items by name or description to retrieve item ID, name & details. Battle in Style and be the last survivor!" />
  <meta property="og:description" content="Search Free Fire game items by name or description to retrieve item ID, name & details." />
  <meta name="keywords" content="Free Fire items, Free Fire item ID, FF items list, Starexx FF, Garena Free Fire, battle royale, Starexx Items, Free Fire items, Free Fire item ID, Garena Free Fire, FF items database, weapon skins, character skins, emotes, bundles, parachutes, loot crates, pet skins, Free Fire cosmetics, Free Fire shop items, FF rare items, FF weapon upgrades, Free Fire gun skins, FF character costumes, Free Fire emoticons, FF vehicle skins, Free Fire gloo wall skins, FF backpacks, Free Fire melee weapons" />
  <meta property="og:title" content="FFItems" />
  <meta property="og:image" content="https://9112000.github.io/FFItems/icons/android-chrome-192x192.png" />
  <meta property="og:type" content="website" />
  <meta name="author" content="Starexx" />
  <meta property="og:url" content="https://9112000.github.io/FFItems/" />
  <meta name="twitter:card" content="summary_large_image" />
  <title>Starexx Items</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <meta name="twitter:title" content="FFItems" />
  <meta name="twitter:description" content="Quickly find Free Fire item IDs, names & details with Starexx Items." />
  <meta name="twitter:image" content="https://9112000.github.io/FFItems/icons/android-chrome-192x192.png" />
  <meta name="google-site-verification" content="joLKEyzfZROYT_Ck4mea3yx94rNwOqRwqalvV-xcA8U" />
  <link rel="canonical" href="https://9112000.github.io/FFItems/" />
  <meta name="robots" content="index, follow" />
</head>
<style>
  :root {
    --bg-primary: #000000;
    --bg-secondary: #111111;
    --bg-tertiary: #121212;
    --bg-card: transparent;
    --border-primary: #222222;
    --border-secondary: #333333;
    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --text-muted: #888888;
    --accent-primary: #ffffff;
    --accent-secondary: #333;
    --hover-primary: #181818;
    --modal-bg: #111111;
    --modal-border: #222222;
    --json-key: #ff79c6;
    --json-string: #f1fa8c;
    --json-number: #bd93f9;
    --json-boolean: #ff79c6;
    --json-null: #ff79c6;
    --header-height: 60px;
    --pill-radius: 20px;
    --modal-radius: 20px;
    --box-radius: 20px;
    --transition-fast: 0.15s ease;
    --transition-medium: 0.2s ease;
    --transition-slow: 0.3s ease;
    --transition-modal: 0.4s cubic-bezier(.4,0,.2,1);
    --transition-flip: 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow-modal: 0 10px 30px rgba(0,0,0,0.5);
    --blur-backdrop: blur(4px);
    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    --font-mono: 'IBM Plex Mono', monospace;
    --font-size-sm: 6px;
    --font-size-md: 12px;
    --font-size-lg: 14px;
    --font-size-xl: 16px;
    --spacing-xs: 12px;
    --spacing-sm: 8px;
    --spacing-md: 8px;
    --spacing-lg: 15px;
    --spacing-xl: 20px;
    --spacing-xxl: 25px;
    --icon-size: 70%;
    --modal-icon-size: 80%;
    --grid-cols: 5;
    --items-per-page: 100;
    --max-width: 800px;
  }

  * {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }
  ::selection {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }
  body {
    margin: 0;
    font-family: var(--font-main);
    background: var(--bg-primary);
    color: var(--text-primary);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: left;
    align-items: center;
    background: var(--bg-primary);
    padding: var(--spacing-md) var(--spacing-xl);
    z-index: 49;
    height: var(--header-height);
    gap: var(--spacing-md);
    flex-wrap: nowrap;
    overflow-x: auto;
    white-space: nowrap;
    max-width: 100%;
  }

  .header::-webkit-scrollbar {
    display: none;
  }

  .header {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .header-pill {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border: none;
    border-radius: var(--pill-radius);
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    transition: background var(--transition-medium);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
    white-space: nowrap;
  }

  .header-pill:hover {
    background: var(--hover-primary);
  }

  .header-pill.active {
    background: var(--accent-secondary);
  }

  .mode-tabs {
    display: flex;
    background: transparent;
    border: none;
    border-right: 1px solid #222;
    border-radius: 0;
    padding: 0.5px 7px;
    gap: var(--spacing-xs);
  }

  .mode-tab {
    padding: 6px var(--spacing-lg);
    border: none;
    border-radius: 16px;
    background: #121212;
    color: var(--text-primary);
    cursor: pointer;
    transition: background var(--transition-medium);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
  }

  .mode-tab.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
  }

  .main-content {
    margin-top: 50px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-cols), 1fr);
    gap: var(--spacing-md);
    width: 90%;
    max-width: var(--max-width);
    margin-bottom: var(--spacing-xl);
  }

  .box {
    background: var(--bg-tertiary);
    border-radius: var(--box-radius);
    aspect-ratio: 1 / 1;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: transform var(--transition-fast), background var(--transition-medium);
    user-select: none;
    border: 1px solid var(--border-primary);
    overflow: hidden;
  }

  .box:active {
    transform: scale(0.9);
    background: var(--hover-primary);
  }

  .icon {
    width: var(--icon-size);
    height: var(--icon-size);
    object-fit: contain;
  }

  .modal {
    position: fixed;
    border-radius: var(--modal-radius);
    background: var(--modal-bg);
    color: var(--text-primary);
    z-index: 100;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all var(--transition-modal);
    overflow: hidden;
    box-shadow: var(--shadow-modal);
    perspective: 1000px;
    border: 1px solid var(--modal-border);
  }

  .modal-content {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform var(--transition-flip);
  }

  .modal.flipped .modal-content {
    transform: rotateY(180deg);
  }

  .modal-front, .modal-back {
    position: absolute;
    width: 100%;
    height: 100%;
    font-size: 10px;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: var(--modal-radius);
    cursor: pointer;
  }

  .modal-back {
    background: var(--bg-card);
    transform: rotateY(180deg);
    padding: var(--spacing-lg);
    overflow: auto;
  }

  .modal-icon {
    width: var(--modal-icon-size);
    height: var(--modal-icon-size);
    object-fit: contain;
    cursor: pointer;
  }

  .json-data {
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    line-height: 1.3;
    white-space: pre-wrap;
    word-break: break-all;
    width: 100%;
    height: 100%;
  }

  .json-key { color: var(--json-key); }
  .json-string { color: var(--json-string); }
  .json-number { color: var(--json-number); }
  .json-boolean { color: var(--json-boolean); }
  .json-null { color: var(--json-null); }

  .fade-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    backdrop-filter: var(--blur-backdrop);
    opacity: 0;
    transition: opacity var(--transition-slow);
    z-index: 50;
    pointer-events: none;
  }

  .fade-bg.active {
    opacity: 1;
    pointer-events: all;
  }

  .bottom-sheet {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--bg-secondary);
    border-radius: var(--modal-radius) var(--modal-radius) 0 0;
    padding: var(--spacing-lg) var(--spacing-xl) var(--spacing-xxl) var(--spacing-xl);
    z-index: 150;
    transform: translateY(100%);
    transition: transform var(--transition-slow);
    max-height: 70vh;
    overflow-y: auto;
  }

  .bottom-sheet.active {
    transform: translateY(0);
  }

  .sheet-header-line {
    width: 40px;
    height: 4px;
    background: var(--border-secondary);
    border-radius: 2px;
    margin: 0 auto var(--spacing-xl) auto;
  }

  .pages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: var(--spacing-md);
  }

  .sheet-page-btn {
    background: transparent;
    color: var(--text-primary);
    border: none;
    border-radius: 30px;
    padding: var(--spacing-md);
    cursor: pointer;
    transition: background var(--transition-medium);
    text-align: center;
    font-size: var(--font-size-lg);
    font-family: var(--font-main);
  }

  .sheet-page-btn.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
  }

  .sheet-page-btn:hover {
    background: var(--hover-primary);
    border: 1px solid var(--border-primary);
  }

  .search-sheet {
    padding: var(--spacing-xl);
  }

  .search-input {
    width: 100%;
    padding: var(--spacing-lg) 18px;
    border-radius: 30px;
    border: 1px solid var(--border-primary);
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-family: inherit;
    outline: none;
    font-size: var(--font-size-xl);
    margin-bottom: var(--spacing-lg);
    font-family: var(--font-main);
  }

  .search-hint {
    font-size: var(--font-size-md);
    color: var(--text-muted);
    text-align: center;
    margin-top: var(--spacing-md);
    font-family: var(--font-main);
  }

  .no-results {
    grid-column: 1 / -1;
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-muted);
    font-family: var(--font-main);
  }

  .loading {
    grid-column: 1 / -1;
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-muted);
    font-family: var(--font-main);
  }

  .search-results-text {
    font-size: var(--font-size-md);
    color: #666;
    text-align: center;
    margin: var(--spacing-md) 0;
    font-family: var(--font-main);
  }

.filter-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-md);
    margin-top: var(--spacing-lg);
}

.filter-btn {
    background: transparent;
    color: var(--text-primary);
    border: 1px solid #181818;
    border-radius: 30px;
    padding: var(--spacing-md);
    cursor: pointer;
    transition: background var(--transition-medium);
    text-align: center;
    font-size: var(--font-size-md);
    font-family: var(--font-main);
    min-height: 45px;
    width: 100%;
}

  .filter-btn.active {
    background: white;
    color: black;
  }

  .filter-btn:hover {
    background: var(--hover-primary);
  }

  .footer {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: var(--bg-primary);
    padding: var(--spacing-md) var(--spacing-xl);
    border: none;
    margin-top: auto;
    margin-bottom: 20px;
  }

  .footer-pill {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border: none;
    border-radius: var(--pill-radius);
    padding: var(--spacing-sm) var(--spacing-lg);
    font-size: var(--font-size-lg);
    font-weight: 500;
    font-family: var(--font-main);
    cursor: pointer;
  }

  .item-details {
    font-family: var(--font-main);
    font-size: var(--font-size-md);
    color: var(--text-secondary);
    line-height: 1.5;
    width: 100%;
    text-align: left;
  }

  .item-name {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 2px;
    text-align: left;
  }

  .item-description {
    margin-bottom: var(--spacing-lg);
    font-size: 8px;
    text-align: left;
  }

  .item-property {
    margin-bottom: var(--spacing-sm);
    display: flex;
    justify-content: space-between;
    font-size: 6px;
  }

  .item-property-label {
    font-weight: 500;
    color: var(--text-primary);
  }

  .item-property-value {
    color: var(--text-secondary);
  }
</style>
<body>
<div class="header">
  <div class="mode-tabs">
    <button class="mode-tab active" id="itemsTab">Items</button>
    <button class="mode-tab" id="iconsTab">Icons</button>
  </div>
  <div class="header-pill type-filter" id="typePill">Type</div>
  <div class="header-pill rarity-filter" id="rarityPill">Rarity</div>
  <div class="header-pill" id="searchPill">Search</div>
</div>

<div class="main-content">
  <div id="searchResults" class="search-results-text"></div>
  <div class="grid" id="grid">
    <div class="loading"></div>
  </div>

  <div class="footer">
    <div class="footer-pill" id="pagePill">Created by Starexx</div>
  </div>
</div>

<div class="fade-bg" id="fadeBg"></div>

<div class="bottom-sheet" id="pageSheet">
  <div class="sheet-header-line"></div>
  <div class="pages-grid" id="pagesGrid"></div>
</div>

<div class="bottom-sheet search-sheet" id="searchSheet">
  <div class="sheet-header-line"></div>
  <input type="text" class="search-input" id="searchInput" placeholder="Search by name, item ID or icon...">
  <div class="search-hint">Type to search through all items</div>
</div>

<div class="bottom-sheet" id="typeSheet">
  <div class="sheet-header-line"></div>
  <div class="filter-grid" id="typeGrid"></div>
</div>

<div class="bottom-sheet" id="raritySheet">
  <div class="sheet-header-line"></div>
  <div class="filter-grid" id="rarityGrid"></div>
</div>
<script>
const grid = document.getElementById('grid');
const fadeBg = document.getElementById('fadeBg');
const pagePill = document.getElementById('pagePill');
const searchPill = document.getElementById('searchPill');
const typePill = document.getElementById('typePill');
const rarityPill = document.getElementById('rarityPill');
const pageSheet = document.getElementById('pageSheet');
const searchSheet = document.getElementById('searchSheet');
const typeSheet = document.getElementById('typeSheet');
const raritySheet = document.getElementById('raritySheet');
const searchInput = document.getElementById('searchInput');
const pagesGrid = document.getElementById('pagesGrid');
const typeGrid = document.getElementById('typeGrid');
const rarityGrid = document.getElementById('rarityGrid');
const searchResults = document.getElementById('searchResults');
const itemsTab = document.getElementById('itemsTab');
const iconsTab = document.getElementById('iconsTab');

let activeClone = null;
let originalBox = null;
let currentPage = 1;
const itemsPerPage = 100;
let allItems = [];
let allIcons = [];
let filteredItems = [];
let filteredIcons = [];
let totalPages = 1;
let currentSearchQuery = "";
let currentMode = "items";
let currentType = "";
let currentRarity = "";
let allTypes = [];
let allRarities = [];

async function fetchData() {
  try {
    const itemsResponse = await fetch('assets/itemData.json');
    if (!itemsResponse.ok) throw new Error('ERROR [JSON]:items');
    allItems = await itemsResponse.json();
    
    allTypes = [...new Set(allItems.map(item => item.type).filter(Boolean))].sort();
    allRarities = [...new Set(allItems.map(item => item.Rare).filter(Boolean))]
    .filter(rarity => rarity !== "255" && rarity !== "NONE")
    .sort();
    const iconsResponse = await fetch('assets/assets.json');
    if (!iconsResponse.ok) throw new Error('ERROR [JSON]:icons');
    const iconsData = await iconsResponse.json();
    
    if (Array.isArray(iconsData)) {
      allIcons = iconsData;
    } else if (typeof iconsData === 'object' && iconsData !== null) {
      allIcons = Object.values(iconsData).filter(item => typeof item === 'string');
    } else {
      allIcons = [];
    }
    
    filteredItems = [...allItems];
    filteredIcons = [...allIcons];
    totalPages = Math.ceil(filteredItems.length / itemsPerPage);
    renderGrid();
    updateHeaderPills();
    updateSearchResultsText();
  } catch (error) {
    grid.innerHTML = '<div class="no-results">Failed to load data. Please check if JSON files exist.</div>';
  }
}

function renderGrid(page = 1, query = "", type = "", rarity = "") {
  grid.innerHTML = "";
  
  if (currentMode === "items") {
    filteredItems = allItems.filter(item => {
      const matchesSearch = !query || 
        item.name?.toLowerCase().includes(query.toLowerCase()) ||
        item.itemID?.toString().includes(query) ||
        item.icon?.toLowerCase().includes(query.toLowerCase()) ||
        item.description?.toLowerCase().includes(query.toLowerCase());
      
      const matchesType = !type || item.type === type;
      const matchesRarity = !rarity || item.Rare === rarity;
      
      return matchesSearch && matchesType && matchesRarity;
    });
    
    currentSearchQuery = query;
    currentType = type;
    currentRarity = rarity;
    
    totalPages = Math.ceil(filteredItems.length / itemsPerPage);
    
    if (filteredItems.length === 0) {
      grid.innerHTML = '<div class="no-results">No items found matching your filters</div>';
      updateHeaderPills();
      updateSearchResultsText();
      return;
    }
    
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = Math.min(startIndex + itemsPerPage, filteredItems.length);
    const itemsToShow = filteredItems.slice(startIndex, endIndex);
    
    itemsToShow.forEach(item => {
      const box = document.createElement('div');
      box.className = 'box';
      
      const icon = document.createElement('img');
      icon.className = 'icon';
      icon.src = `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${item.icon}.png`;
      icon.alt = item.name || 'Item Icon';
      icon.onerror = function() {
        this.src = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
      };
      
      box.appendChild(icon);
      box.addEventListener('click', () => openModal(box, item));
      grid.appendChild(box);
    });
  } else {
    if (query) {
      filteredIcons = allIcons.filter(iconName => 
        iconName.toLowerCase().includes(query.toLowerCase())
      );
      currentSearchQuery = query;
    } else {
      filteredIcons = [...allIcons];
      currentSearchQuery = "";
    }
    
    totalPages = Math.ceil(filteredIcons.length / itemsPerPage);
    
    if (filteredIcons.length === 0) {
      grid.innerHTML = '<div class="no-results">No icons found matching your search</div>';
      updateHeaderPills();
      updateSearchResultsText();
      return;
    }
    
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = Math.min(startIndex + itemsPerPage, filteredIcons.length);
    const iconsToShow = filteredIcons.slice(startIndex, endIndex);
    
    iconsToShow.forEach(iconName => {
      const box = document.createElement('div');
      box.className = 'box';
      
      const icon = document.createElement('img');
      icon.className = 'icon';
      
      if (iconName.includes('https://')) {
        icon.src = iconName;
      } else {
        icon.src = `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${iconName}.png`;
      }
      
      icon.alt = iconName;
      icon.onerror = function() {
        this.src = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
      };
      
      box.appendChild(icon);
      
      const iconData = {
        icon: extractIconName(iconName)
      };
      
      box.addEventListener('click', () => openModal(box, iconData));
      grid.appendChild(box);
    });
  }
  
  updateSearchResultsText();
}

function extractIconName(iconString) {
  if (iconString.includes('https://')) {
    const url = new URL(iconString);
    const pathSegments = url.pathname.split('/');
    const fileName = pathSegments[pathSegments.length - 1];
    return fileName.replace('.png', '');
  }
  return iconString;
}

function updateHeaderPills() {
  pagePill.textContent = `Page ${currentPage}/${totalPages}`;
  
  if (currentSearchQuery) {
    searchPill.textContent = currentSearchQuery;
  } else {
    searchPill.textContent = "Search";
  }
  
  if (currentMode === "items") {
    document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
      el.style.display = 'block';
    });
    
    if (currentType) {
      typePill.textContent = currentType;
      typePill.classList.add('active');
    } else {
      typePill.textContent = "Type";
      typePill.classList.remove('active');
    }
    
    if (currentRarity) {
      let displayRarity = currentRarity;
      if (currentRarity === 'ORANGE_PLUS') displayRarity = 'ORANGE+';
      if (currentRarity === 'PURPLE_PLUS') displayRarity = 'PURPLE+';
      rarityPill.textContent = displayRarity;
      rarityPill.classList.add('active');
    } else {
      rarityPill.textContent = "Rarity";
      rarityPill.classList.remove('active');
    }
  } else {
    document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
      el.style.display = 'none';
    });
  }
}

function updateSearchResultsText() {
  if (currentSearchQuery || currentType || currentRarity) {
    const itemCount = currentMode === "items" ? filteredItems.length : filteredIcons.length;
    let filterText = [];
    if (currentSearchQuery) filterText.push(`"${currentSearchQuery}"`);
    if (currentType) filterText.push(`Type: ${currentType}`);
    if (currentRarity) {
      let displayRarity = currentRarity;
      if (currentRarity === 'ORANGE_PLUS') displayRarity = 'ORANGE+';
      if (currentRarity === 'PURPLE_PLUS') displayRarity = 'PURPLE+';
      filterText.push(`Rarity: ${displayRarity}`);
    }
    
    searchResults.textContent = `Showing results for ${filterText.join(', ')} - ${itemCount} ${currentMode} found`;
  } else {
    searchResults.textContent = "";
  }
}

function openTypeSheet() {
  typeGrid.innerHTML = "";
  
  const allBtn = document.createElement('button');
  allBtn.className = `filter-btn ${!currentType ? 'active' : ''}`;
  allBtn.textContent = 'All Types';
  allBtn.onclick = () => {
    renderGrid(1, currentSearchQuery, "", currentRarity);
    updateHeaderPills();
    closeAllSheets();
  };
  typeGrid.appendChild(allBtn);
  
  allTypes.forEach(type => {
    const btn = document.createElement('button');
    btn.className = `filter-btn ${currentType === type ? 'active' : ''}`;
    btn.textContent = type;
    btn.onclick = () => {
      renderGrid(1, currentSearchQuery, type, currentRarity);
      updateHeaderPills();
      closeAllSheets();
    };
    typeGrid.appendChild(btn);
  });
  
  typeSheet.classList.add('active');
  fadeBg.classList.add('active');
}

function openRaritySheet() {
  rarityGrid.innerHTML = "";
  
  const allBtn = document.createElement('button');
  allBtn.className = `filter-btn ${!currentRarity ? 'active' : ''}`;
  allBtn.textContent = 'All Rarities';
  allBtn.onclick = () => {
    renderGrid(1, currentSearchQuery, currentType, "");
    updateHeaderPills();
    closeAllSheets();
  };
  rarityGrid.appendChild(allBtn);
  
  allRarities.forEach(rarity => {
    const btn = document.createElement('button');
    btn.className = `filter-btn ${currentRarity === rarity ? 'active' : ''}`;
    
    let displayName = rarity;
    if (rarity === 'ORANGE_PLUS') {
      displayName = 'ORANGE+';
    } else if (rarity === 'PURPLE_PLUS') {
    displayName = 'PURPLE+';
    }
    
    btn.textContent = displayName;
    btn.onclick = () => {
      renderGrid(1, currentSearchQuery, currentType, rarity);
      updateHeaderPills();
      closeAllSheets();
    };
    rarityGrid.appendChild(btn);
  });
  
  raritySheet.classList.add('active');
  fadeBg.classList.add('active');
}

function openPageSheet() {
  pagesGrid.innerHTML = "";
  
  for (let i = 1; i <= totalPages; i++) {
    const btn = document.createElement('button');
    btn.className = 'sheet-page-btn';
    btn.textContent = i;
    if (i === currentPage) btn.classList.add('active');
    btn.onclick = () => {
      currentPage = i;
      renderGrid(currentPage, currentSearchQuery, currentType, currentRarity);
      updateHeaderPills();
      closeAllSheets();
    };
    pagesGrid.appendChild(btn);
  }
  
  pageSheet.classList.add('active');
  fadeBg.classList.add('active');
}

function openSearchSheet() {
  searchInput.value = currentSearchQuery;
  searchSheet.classList.add('active');
  fadeBg.classList.add('active');
  
  setTimeout(() => {
    searchInput.focus();
  }, 300);
}

function closeAllSheets() {
  pageSheet.classList.remove('active');
  searchSheet.classList.remove('active');
  typeSheet.classList.remove('active');
  raritySheet.classList.remove('active');
  fadeBg.classList.remove('active');
}

function createPrettyDetails(item) {
  const detailsContainer = document.createElement('div');
  detailsContainer.className = 'item-details';
  
  // Name
  if (item.name) {
    const nameElement = document.createElement('div');
    nameElement.className = 'item-name';
    nameElement.textContent = item.name;
    detailsContainer.appendChild(nameElement);
  }
  
  // Description
  if (item.description) {
    const descElement = document.createElement('div');
    descElement.className = 'item-description';
    descElement.textContent = item.description;
    detailsContainer.appendChild(descElement);
  }
  
  // Item ID
  if (item.itemID) {
    const idElement = document.createElement('div');
    idElement.className = 'item-property';
    
    const idLabel = document.createElement('span');
    idLabel.className = 'item-property-label';
    idLabel.textContent = 'Item ID:';
    
    const idValue = document.createElement('span');
    idValue.className = 'item-property-value';
    idValue.textContent = item.itemID;
    
    idElement.appendChild(idLabel);
    idElement.appendChild(idValue);
    detailsContainer.appendChild(idElement);
  }
  
  // Icon
  if (item.icon) {
    const iconElement = document.createElement('div');
    iconElement.className = 'item-property';
    
    const iconLabel = document.createElement('span');
    iconLabel.className = 'item-property-label';
    iconLabel.textContent = 'Icon:';
    
    const iconValue = document.createElement('span');
    iconValue.className = 'item-property-value';
    iconValue.textContent = item.icon;
    
    iconElement.appendChild(iconLabel);
    iconElement.appendChild(iconValue);
    detailsContainer.appendChild(iconElement);
  }
  
  // Type and Rarity
  if (item.type || item.Rare) {
    const typeRarityElement = document.createElement('div');
    typeRarityElement.className = 'item-property';
    
    let typeRarityText = '';
    if (item.type && item.Rare) {
      typeRarityText = `${item.type} in ${item.Rare} rarity`;
    } else if (item.type) {
      typeRarityText = `${item.type}`;
    } else if (item.Rare) {
      typeRarityText = `${item.Rare} rarity`;
    }
    
    const typeRarityValue = document.createElement('span');
    typeRarityValue.className = 'item-property-value';
    typeRarityValue.textContent = typeRarityText;
    
    typeRarityElement.appendChild(typeRarityValue);
    detailsContainer.appendChild(typeRarityElement);
  }
  
  return detailsContainer;
}

function openModal(box, item) {
  if (activeClone) return;
  document.body.style.overflow = 'hidden';
  document.body.style.touchAction = 'none';
  const rect = box.getBoundingClientRect();
  const modal = document.createElement('div');
  modal.classList.add('modal');
  modal.style.left = rect.left + 'px';
  modal.style.top = rect.top + 'px';
  modal.style.width = rect.width + 'px';
  modal.style.height = rect.height + 'px';

  const modalContent = document.createElement('div');
  modalContent.className = 'modal-content';

  const modalFront = document.createElement('div');
  modalFront.className = 'modal-front';
  
  const modalIcon = document.createElement('img');
  modalIcon.className = 'modal-icon';
  
  if (item.icon.includes('https://')) {
    modalIcon.src = item.icon;
  } else {
    modalIcon.src = `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${item.icon}.png`;
  }
  
  modalIcon.alt = item.name || item.icon;
  modalIcon.onerror = function() {
    this.src = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
  };
  
  modalFront.appendChild(modalIcon);

  const modalBack = document.createElement('div');
  modalBack.className = 'modal-back';
  
  // Use pretty details instead of JSON
  const detailsContainer = createPrettyDetails(item);
  modalBack.appendChild(detailsContainer);

  modalIcon.addEventListener('click', (e) => {
    e.stopPropagation();
    modal.classList.add('flipped');
  });

  modalBack.addEventListener('click', (e) => {
    e.stopPropagation();
    modal.classList.remove('flipped');
  });

  modalContent.appendChild(modalFront);
  modalContent.appendChild(modalBack);
  modal.appendChild(modalContent);

  document.body.appendChild(modal);

  requestAnimationFrame(() => {
    fadeBg.classList.add('active');
    modal.style.left = '50%';
    modal.style.top = '50%';
    modal.style.transform = 'translate(-50%, -50%) scale(1.8)';
    modal.style.width = '200px';
    modal.style.height = '200px';
  });

  fadeBg.addEventListener('click', closeModal);

  activeClone = modal;
  originalBox = box;
}

function closeModal() {
  if (!activeClone || !originalBox) return;
  document.body.style.overflow = '';
  document.body.style.touchAction = '';

  fadeBg.removeEventListener('click', closeModal);
  
  const rect = originalBox.getBoundingClientRect();
  fadeBg.classList.remove('active');

  if (activeClone.classList.contains('flipped')) {
    activeClone.classList.remove('flipped');
    
    setTimeout(() => {
      activeClone.style.left = rect.left + 'px';
      activeClone.style.top = rect.top + 'px';
      activeClone.style.width = rect.width + 'px';
      activeClone.style.height = rect.height + 'px';
      activeClone.style.transform = 'translate(0,0) scale(1)';

      setTimeout(() => {
        activeClone.remove();
        activeClone = null;
      }, 400);
    }, 300);
  } else {
    activeClone.style.left = rect.left + 'px';
    activeClone.style.top = rect.top + 'px';
    activeClone.style.width = rect.width + 'px';
    activeClone.style.height = rect.height + 'px';
    activeClone.style.transform = 'translate(0,0) scale(1)';

    setTimeout(() => {
      activeClone.remove();
      activeClone = null;
    }, 400);
  }
}

function switchMode(mode) {
  currentMode = mode;
  currentPage = 1;
  currentSearchQuery = "";
  currentType = "";
  currentRarity = "";
  
  itemsTab.classList.toggle('active', mode === 'items');
  iconsTab.classList.toggle('active', mode === 'icons');
  
  searchInput.placeholder = mode === 'items' 
    ? 'Search by name, item ID or icon...' 
    : 'Search icons...';
  
  renderGrid();
  updateHeaderPills();
}

searchInput.addEventListener('input', (e) => {
  currentPage = 1;
  renderGrid(currentPage, e.target.value.trim(), currentType, currentRarity);
  updateHeaderPills();
});

pagePill.addEventListener('click', openPageSheet);
searchPill.addEventListener('click', openSearchSheet);
typePill.addEventListener('click', openTypeSheet);
rarityPill.addEventListener('click', openRaritySheet);

itemsTab.addEventListener('click', () => switchMode('items'));
iconsTab.addEventListener('click', () => switchMode('icons'));

fadeBg.addEventListener('click', () => {
  closeModal();
  closeAllSheets();
});
document.addEventListener('touchmove', function(e) {
  if (activeClone) {
    e.preventDefault();
  }
}, { passive: false });

fetchData();
</script>
</body>
</html>
